---
title: "Ajuste de Curvas"
subtitle: "M√©todos Num√©ricos"
author: "Prof. Dr. Raphael Teixeira"
date: ""
format: 
  revealjs:
    footer: "UFPA - CAMTUC - FEE  - Ajuste de Curvas"
    slide-number: true
    transition: fade
editor: visual
---

### üéØ O Problema do Ajuste de Curvas



Construir fun√ß√£o matem√°tica, que tenha o "melhor ajuste" para uma s√©rie de dados observados, sujeitos a erros.

```{python}
#| label: fig-ajuste-linear
#| echo: False
#| fig-align: center
#| out-width: "80%"

import numpy as np
import matplotlib.pyplot as plt
plt.rcParams['font.size'] = 14
plt.rcParams['legend.fontsize'] = 14 

# 1. Dados Observados
xm = np.array([2.5, 3.1, 4.5, 5.3, 6.0, 6.9, 8.0])
ym = np.array([2.0, 2.8, 3.5, 4.6, 5.0, 5.2, 6.5])

# 2. C√°lculo do Ajuste Linear (usando polyfit de grau 1)
# Retorna os coeficientes [a1, a0]
theta = np.polyfit(xm, ym, 1) 
a1 = theta[0]
a0 = theta[1]

# 3. Gerar a Reta de Ajuste
y = a0 + a1 * xm 

# 4. Cria√ß√£o do Gr√°fico
plt.figure(figsize=(8, 4))
plt.scatter(xm, ym, color='blue', label='Dados')
plt.plot(xm, y, color='red', linestyle='-', label=f'Modelo: y = {a1:.2f}x + {a0:.2f}')

plt.xlabel('x')
plt.ylabel('y')
plt.legend()
plt.grid(True)
plt.show()
```

---

### üéØ O Problema do Ajuste de Curvas

Construir fun√ß√£o matem√°tica, que tenha o "melhor ajuste" para uma s√©rie de dados observados, sujeitos a erros.

```{python}
#| label: fig-ajuste-linear-erro
#| echo: False
#| fig-align: center
#| out-width: "80%"

import numpy as np
import matplotlib.pyplot as plt
plt.rcParams['font.size'] = 14
plt.rcParams['legend.fontsize'] = 14 

# 1. Dados Observados
xm = np.array([2.5, 3.1, 4.5, 5.3, 6.0, 6.9, 8.0])
ym = np.array([2.0, 2.8, 3.5, 4.6, 5.0, 5.2, 6.5])

# 2. C√°lculo do Ajuste Linear (usando polyfit de grau 1)
# Retorna os coeficientes [a1, a0]
theta = np.polyfit(xm, ym, 1) 
a1 = theta[0]
a0 = theta[1]

# 3. Gerar a Reta de Ajuste
y = a0 + a1 * xm 

# 4. Cria√ß√£o do Gr√°fico
plt.figure(figsize=(8, 4))
plt.scatter(xm, ym, color='blue', label='Dados')
plt.plot(xm, y, color='red', linestyle='-', label=f'Modelo: y = {a1:.2f}x + {a0:.2f}')

plt.xlabel('x')
plt.ylabel('y')
plt.legend()
plt.grid(True)
plt.show()
```


---
### üìâ Gr√°fico do Ajuste Linear pelo M√©todo dos M√≠nimos Quadrados


::: incremental
-   **Interpola√ß√£o:** A curva **passa** exatamente por todos os pontos (exato).
-   **Ajuste:** A curva **se aproxima** da tend√™ncia dos pontos (aproximado).
:::

---

### Objetivos

1.  Determinar a fun√ß√£o que melhor representa o fen√¥meno.
2.  Permitir a **predi√ß√£o** de valores fora da faixa de dados observados (extrapola√ß√£o).

------------------------------------------------------------------------

### üìà M√©todo dos M√≠nimos Quadrados

### A Base do Ajuste

O m√©todo dos m√≠nimos quadrados (MMQ) √© a t√©cnica mais comum para encontrar o ajuste. Ele minimiza o erro quadr√°tico total.

$$
E = \sum_{i=1}^{n} [y_i - f(x_i)]^2
$$

Onde:

-   $E$ √© o erro quadr√°tico total.
-   $y_i$ √© o valor real (observado).
-   $f(x_i)$ √© o valor previsto pela fun√ß√£o de ajuste.

### Minimiza√ß√£o

Para encontrar os par√¢metros √≥timos (ex: $a_0$ e $a_1$ em uma reta), calculamos as derivadas parciais do erro $E$ em rela√ß√£o a cada par√¢metro e as igualamos a zero:

$$
\frac{\partial E}{\partial a_k} = 0
$$

------------------------------------------------------------------------

### üìè Ajuste Linear (Reta)

### Equa√ß√£o da Reta

Assumimos que o modelo de melhor ajuste √© uma reta:

$$
y = a_0 + a_1 x
$$

### Sistema de Equa√ß√µes Normais

A aplica√ß√£o do MMQ leva ao seguinte sistema (para encontrar $a_0$ e $a_1$):

$$
\begin{cases}
n a_0 + (\sum x_i) a_1 = \sum y_i \\
(\sum x_i) a_0 + (\sum x_i^2) a_1 = \sum x_i y_i
\end{cases}
$$

Este √© um sistema linear $2 \times 2$ que pode ser resolvido por m√©todos como Elimina√ß√£o Gaussiana ou Cramer.

------------------------------------------------------------------------

### üíª Exemplo em C√≥digo

Vamos supor que temos os seguintes dados:

| $x$ | $y$ |
|-----|-----|
| 1.0 | 0.5 |
| 2.0 | 2.5 |
| 3.0 | 2.0 |
| 4.0 | 4.0 |
| 5.0 | 3.5 |

### Implementa√ß√£o em Python

\`\`\`python import numpy as np

### Dados de exemplo

x = np.array(\[1.0, 2.0, 3.0, 4.0, 5.0\]) y = np.array(\[0.5, 2.5, 2.0, 4.0, 3.5\])

# C√°lculo dos coeficientes pelo numpy (polyfit)

### O grau 1 indica ajuste linear

coefs = np.polyfit(x, y, 1)

print(f"Coeficiente a1 (inclina√ß√£o): {coefs\[0\]:.4f}") print(f"Coeficiente a0 (intercepto): {coefs\[1\]:.4f}")